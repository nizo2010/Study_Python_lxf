# Chapter_052 模块base64

Base64是一种用64个字符来表示任意二进制数据的方法。

不知道大家有没有这样的经历，使用记事本或者Notepad++等工具打开一个exe、jpg、pdf等后缀的文件时，会显示一大堆的乱码，这是因为这些二进制文件包含很多无法显示和打印的字符。

所以，如果要让Notepad++这样的文本处理软件能处理二进制数据，就需要一个二进制到字符串的转换方法。

Base64是一种最常见的二进制编码方法。

Base64的原理很简单，首先准备一个包含64个字符的数组，数组包含A-B（26个）、a-b（26个）、0-9（10个）和+、/字符。（实际上还有一个作为垫字的"="，共65个字符）。

```python
['A', 'B', 'C', ..., 'a', 'b', 'c', ..., '0', '1', '2', ..., '+', '/']
```

转换方式分为四步：

- 第一步，将每三个字节作为一组，一共是24个二进制位。

- 第二步，将这24个二进制位分为四组，每个组有6个二进制位。

- 第三步，在每组前面加两个00，扩展成32个二进制位，即四个字节。

- 第四步，根据下表，得到扩展后的每隔字节对应的符号，这就是Base64的编码值。

|序号 | 编码 |序号 | 编码 |序号 | 编码 |序号 | 编码 |
| ---- | ----- | ---- | ---- | ---- | ----- | ---- | ---- |
| 0 | A | 16 | Q | 32 | g | 48 | w |
| 1 | B | 17 | R | 33 | h | 49 | x |
| 2 | C | 18 | S | 34 | i | 50 | y |
| 3 | D | 19 | T | 35 | j | 51 | z |
| 4 | E | 20 | U | 36 | k | 52 | 0 |
| 5 | F | 21 | V | 37 | l | 53 | 1 |
| 6 | G | 22 | W | 38 | m | 54 | 2 |
| 7 | H | 23 | X | 39 | n | 55 | 3 |
| 8 | I | 24 | Y | 40 | o | 56 | 4 |
| 9 | J | 25 | Z | 41 | p | 57 | 5 |
| 10 | K | 26 | a | 42 | q | 58 | 6 |
| 11 | L | 27 | b | 43 | r | 59 | 7 |
| 12 | M | 28 | c | 44 | s | 60 | 8 |
| 13 | N | 29 | d | 45 | t | 61 | 9 |
| 14 | O | 30 | e | 46 | u | 62 | + |
| 15 | P | 31 | f | 47 | v | 63 | / |

因此，Base64将三个字节转化成四个字节，因此Base64编码后的文本，会比原文本大出三分之一。

那这么做的好处是什么呢？

1、所有的二进制文件，都可以因此转化为可打印的文本编码，进而使用文本处理软件进行编辑；

2、能够对文本进行简单的加密。

## 示例1：演示英文单词Man如何转化成Base64编码

- 第一步,"M"、"a"、"n"的ASCII值分别为77、97、110，对应的二进制值为01001101、01100001、01101110,，将它们连成一个24位的二进制字符串为010011010110000101101110。

- 第二步，将这个24位的二进制字符串分成4组，每组6个二进制位：010011、010110、000101、101110。

- 第三步，在每组前面加两个00，扩展成32个二进制位，即四个字节：00010011、00010110、00000101、00101110。它们的十进制分别为19、22、5、46。

- 第四步，根据Base64的编码表，得到每个值对应的Base64编码，即T、W、F、u。

因此，Man的Base64编码就是TWFu。


## 字节数不足三个字节的处理方式

> 1、 两个字节的情况：将这两个字节的一共16个二进制，按照规则，转成三组，分别是6、6、4个二进制位，最后一组除了前面加两个00之外，后面也要加两个00。这样得到一个三位的Base64编码，再在末尾补上一个"="号，组成四个Base64编码、””
> 
> 比如，"Ma"这个字符串是两个字节，分别对应的ASCII值为77和97，对应的二进制值为01001101和01100001，组合起来就是0100110101100001（16位），分成三组为010011、010110、0001（分别为6个、6个和4个二进制位），按照规则添加两个00（其中最后一组在末尾也要添加两个00），得到00010011、00010110和00000100，分别对应的十进制值为19、22和4，按照Base64编码表，得到的编码分别为T、W、E，最后再补上一个"="号，因此"Ma"的Base64编码就是"TWE="。

> 2、 一个字节的情况：将这一个字节的一共8个二进制位，按照规则，转成两组，分别是6、2个二进制位，最后一组除了前面加两个00之外，后面再加四个00。这样得到一个两位的Base64编码，再在末尾补上两个"="号。
>
> 比如，"M"这个字母是一个字节，对应的ASCII值为77，二进制值为01001101，分成两组为010011、01，按照规则添加两个00（其中最后一组在末尾也要添加四个00），得到00010011、00010000，分别对应的十进制值为19和16，按照Base64编码表，得到的编码分别为T、Q，最后再补上两个"="号，因此"M"的Base64编码就是"TQ=="。


## 汉字转化为Base64编码




## 链接

上一节 [Chapter_053 模块collections](https://github.com/nizo2010/Study_Python_lxf/blob/master/Chapter_053.md "Chapter_051 模块collections")

下一节 [Chapter_055 模块struct](https://github.com/nizo2010/Study_Python_lxf/blob/master/Chapter_055.md "Chapter_053 模块struct")
